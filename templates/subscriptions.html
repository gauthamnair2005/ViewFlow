{% extends 'base.html' %}

{% block content %}
<div class="subscriptions-page">
    <!-- Channel Bar -->
    <div class="channel-bar" style="display: flex; overflow-x: auto; gap: 1rem; padding: 1rem 0; margin-bottom: 2rem; scrollbar-width: none; -ms-overflow-style: none;">
        <a href="{{ url_for('main.subscriptions') }}" class="channel-chip active" style="display: flex; flex-direction: column; align-items: center; min-width: 70px; text-decoration: none; color: var(--text-main);">
            <div style="width: 56px; height: 56px; border-radius: 50%; background: var(--accent); display: flex; align-items: center; justify-content: center; margin-bottom: 0.5rem; border: 2px solid var(--accent);">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z"/></svg>
            </div>
            <span style="font-size: 0.8rem; font-weight: 500;">All</span>
        </a>
        
        {% for channel in channels %}
        <a href="{{ url_for('main.user_profile', username=channel.username) }}" class="channel-chip" style="display: flex; flex-direction: column; align-items: center; min-width: 70px; text-decoration: none; color: var(--text-main);">
            {% if channel.profile_pic %}
                <img src="{{ url_for('main.uploaded_file', filename=channel.profile_pic) }}" alt="{{ channel.username }}" style="width: 56px; height: 56px; border-radius: 50%; object-fit: cover; margin-bottom: 0.5rem; border: 2px solid transparent;">
            {% else %}
                <div style="width: 56px; height: 56px; border-radius: 50%; background: var(--bg-sec); display: flex; align-items: center; justify-content: center; margin-bottom: 0.5rem; font-weight: bold; font-size: 1.2rem; border: 2px solid transparent;">
                    {{ channel.username[0].upper() }}
                </div>
            {% endif %}
            <span style="font-size: 0.8rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 80px;">{{ channel.display_name or channel.username }}</span>
        </a>
        {% endfor %}
    </div>

    <!-- Video Grid -->
    <h3 style="margin-bottom: 1.5rem;">Latest from your subscriptions</h3>
    
    {% if videos %}
        <section class="recommended">
            <div class="recommended-grid">
                {% for video in videos %}
                <article class="recommended-card">
                    <a href="{{ url_for('main.watch', video_id=video.id) }}">
                        <div class="rec-thumb">
                            {% if video.thumbnail %}
                                <img src="{{ url_for('main.uploaded_file', filename=video.thumbnail) }}" alt="{{ video.title }}">
                            {% else %}
                                <div class="thumb-placeholder"><svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor"><path d="M8 5v14l11-7z"/></svg></div>
                            {% endif %}
                        </div>
                        <div class="rec-meta">
                            <h3 class="rec-title">{{ video.title }}</h3>
                            <p class="rec-channel">{{ video.uploader.display_name or video.uploader.username }}</p>
                            <p class="rec-stats">{{ video.views }} views â€¢ {{ video.upload_date.strftime('%b %d, %Y') }}</p>
                        </div>
                    </a>
                </article>
                {% endfor %}
            </div>
        </section>
    {% else %}
        <div class="empty-state" style="text-align: center; padding: 4rem 0; color: var(--text-sec);">
            <svg viewBox="0 0 24 24" width="64" height="64" fill="currentColor" style="opacity: 0.5; margin-bottom: 1rem;"><path d="M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.41 11.93 6 13.34l6.34 6.34 11.9-11.9-1.41-1.41z"/></svg>
            <h3>No videos found</h3>
            <p>Subscribe to channels to see their latest videos here.</p>
        </div>
    {% endif %}
</div>

<style>
    .channel-bar::-webkit-scrollbar {
        display: none;
    }
    .channel-chip:hover img, .channel-chip:hover div {
        border-color: var(--text-sec);
    }
    .channel-chip.active div {
        background: var(--accent);
        color: white;
    }
</style>
{% endblock %}
