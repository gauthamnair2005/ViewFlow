{% extends 'base.html' %}
{% block content %}
    {% macro video_section(title, videos) %}
        {% if videos %}
        <h2 style="margin-bottom: 20px; margin-top: 30px;">{{ title }}</h2>
        <section class="recommended">
            <div class="recommended-grid">
                {% for video in videos %}
                <article class="recommended-card">
                    <a href="{{ url_for('main.watch', video_id=video.id) }}">
                        <div class="rec-thumb">
                            {% if video.thumbnail %}
                                <img src="{{ url_for('main.uploaded_file', filename=video.thumbnail) }}" alt="{{ video.title }}">
                            {% else %}
                                <div class="thumb-placeholder"><svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor"><path d="M8 5v14l11-7z"/></svg></div>
                            {% endif %}
                        </div>
                        <div class="rec-meta">
                            <h3 class="rec-title">{{ video.title }}</h3>
                            <p class="rec-channel">{{ video.uploader.display_name or video.uploader.username }}</p>
                            <p class="rec-stats">{{ video.views }} views â€¢ {{ video.upload_date|format_date }}</p>
                        </div>
                    </a>
                </article>
                {% endfor %}
            </div>
        </section>
        {% endif %}
    {% endmacro %}

    {% if not for_you and not latest and not trending %}
        <div style="text-align: center; padding: 50px;">
            <h3>No videos yet!</h3>
            <p>Be the first to upload content to ViewFlow.</p>
        </div>
    {% else %}
        {{ video_section('For You', for_you) }}
        {{ video_section('Latest', latest) }}
        {{ video_section('Trending', trending) }}
        {% if featured_channel %}
            {{ video_section('From ' ~ (featured_channel.display_name or featured_channel.username), channel_videos) }}
        {% endif %}
    {% endif %}
{% endblock %}
